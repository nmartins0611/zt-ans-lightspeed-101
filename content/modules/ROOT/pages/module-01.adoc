= Lab Guide: Configuring Ansible Lightspeed in VS Code
:doctype: book
:notoc:
:toc-title: Table of Contents
:nosectnums:
:icons: font

_A guide to enabling and activating Ansible Lightspeed within the Ansible Visual Studio Code extension._

---

== Introduction and Lab Setup

In this lab, you will configure Ansible Lightspeed in Visual Studio Code. This lab uses a built-in licensed user seat to access the Ansible Lightspeed service.

The examples used in this lab are available in the link:https://github.com/ansible/ansible-lightspeed-demos[Ansible Lightspeed Demo repository].

Your lab environment has three tabs at the top: `RHEL`, `RHEL-New Tab`, and `Controller`.

* The **RHEL** tab provides remote desktop access to a Red Hat Enterprise Linux workstation with Visual Studio Code pre-installed.
* The **Controller** tab connects you to the link:https://www.ansible.com/products/controller[automation controller], which you will use in later challenges.

image::../assets/RHEL9_desktop.png[RHEL 9 Desktop Environment, opts="border"]

[NOTE]
====
You can perform the lab work in either the `RHEL` tab or the `RHEL-New Tab`. If the resolution feels small, you can hide the instructions sidebar or use the `RHEL-New Tab` to work in a full-screen browser window.

If the embedded RHEL screen becomes unresponsive, please try refreshing the page.
====

The login credentials for the `Controller` and the RHEL workstation's Cockpit interface are:

* **Username:** `student`
* **Password:** `learn_ansible`

---

== Copy and Paste Instructions for the RHEL Workstation

The lab uses a VNC browser instance to access the RHEL workstation. Some browsers, like Firefox and Safari, do not support direct copy and paste. The **Chrome** browser is recommended.

If you are not using Chrome, you can use the **VNC Clipboard utility** to copy and paste between your local machine and the lab instance.

.   **Open the VNC Clipboard utility** on the `RHEL` tab by pressing:
    * `CTRL`+`ALT`+`SHIFT` on Windows or Linux.
    * `CTRL`+`OPTION`+`SHIFT` on Mac.

.   **Use the clipboard text area** as an interface between your local and remote clipboards.
+
image:../assets/vnc_sidebar_clipboard.png[VNC sidebar clipboard utility, opts="border"]

.   **Close the utility** by pressing the same key combination again.

---

== Task 1: Enable Ansible Lightspeed

First, you will enable the Ansible Lightspeed features within the VS Code extension settings.

.   **Open Visual Studio Code** by double-clicking the icon on the RHEL desktop.
+
image:../assets/vscode_open.png[VS Code icon on the desktop, opts="border"]

.   **Navigate to the Ansible extension settings.**
+
    **Click** the **Extensions** icon on the left sidebar, find the **Ansible** extension, **click** the gear icon (⚙️), and select **Extension Settings**.
+
image:../assets/open_extension_settings.png[Opening extension settings, opts="border"]

.   **Filter the settings for Lightspeed.**
+
    **Click** the **Workspace** tab *(arrow 1)* and type `lightspeed` in the search bar *(arrow 2)* to filter the options.
+
image:../assets/lightspeed-101-4-vscode-settings.png[Filtering for Lightspeed settings in the Workspace tab, opts="border"]

.   **Enable the Lightspeed features.**
+
    **Check** both boxes to enable the functionality:
+
    * Enable Ansible Lightspeed
    * Enable Ansible Lightspeed with Watson Code Assistant inline suggestions
+
image::../assets/lightspeed-101-5-vscode-settings.png[Enabling both Lightspeed options, opts="border"]

[IMPORTANT]
====
Please ensure you configure these settings in the VS Code **Workspace** tab, not the User tab.
====

---

== Task 2: Activate Ansible Lightspeed

Next, you will connect your VS Code instance to the Ansible Lightspeed service.

.   **Begin the connection process.**
+
    **Click** the Ansible extension icon on the left sidebar, then **click** **Connect**.
+
image:../assets/lightspeed-101-6-connect-vscode-settings.png[Connect to Ansible Lightspeed, opts="border"]

.   **Follow the authentication prompts.**
+
    A series of pop-ups will guide you through the authentication process. **Click Allow** and **Open** when prompted.
+
image:../assets/lightspeed-101-7-signin-vscode-settings.png[Sign-in prompt, opts="border"]
image:../assets/lightspeed-101-8-openauth-vscode-settings.png[Open authentication link prompt, opts="border"]

.   **Authorize the application in Firefox.**
+
    A Firefox browser window will open.
+
    a. The first step is to log in. The credentials are pre-loaded for this lab, so simply **click the login button**.
+
image:../assets/lightspeed-101-9-login-vscode-settings.png[Login button in Firefox, opts="border"]
+
    b. In the new pop-up, **click** the **Authorize** button.
+
image:../assets/lightspeed-101-10-auth-vscode-settings.png[Authorize button, opts="border"]
+
    c. In the final Firefox pop-up, **click** the **Open Link** button.
+
image:../assets/lightspeed-101-11-openlink-vscode-settings.png[Open Link button, opts="border"]

.   **Confirm the link in VS Code.**
+
    Return to VS Code, where a pop-up will ask you to open the URL. **Click** the **Open** button.
+
image:../assets/lightspeed-101-12-openurl-vscode-settings.png[Open URL prompt in VS Code, opts="border"]

.   **Verify the connection.**
+
    Once you have successfully logged in and authorized the service, you will see `Logged in as...` in the Ansible extension sidebar and a confirmation pop-up in the bottom right corner of VS Code.
+
image:../assets/lightspeed-101-13-verifyenabled-vscode-settings.png[Successful login verification, opts="border"]

[WARNING]
====
If you receive a timeout warning, don't worry. Just click **Connect** in the Ansible extension again and repeat the authorization steps in Firefox.
image:../assets/vscode_login_timeout.png[Login timeout warning, opts="border"]
====

---

== Next Steps

Press the `Check` button below to proceed to the next challenge.

=== Need Help?

* **Solution Video:** A solution video is available below.
* **Skip This Challenge:** You can click the `Skip` button at the bottom right to move to the next challenge.
+
[NOTE]
====
Please do not skip this challenge, otherwise you will not be able to get suggestions from Ansible Lightspeed.
====

=== Solution Video

.Enable Ansible Lightspeed and Activate it
video::../assets/lightspeed_setup.gif[youtube]

---

== Additional Resources

* link:https://www.redhat.com/en/technologies/management/ansible/ansible-lightspeed[More information] on Red Hat Ansible Lightspeed with IBM watsonx Code Assistant.
* link:https://www.redhat.com/en/engage/redhat-ansible-automation-202108061218[Self-paced exercises] - Explore all our self-paced Ansible labs.
* link:http://red.ht/try_ansible[Trial subscription] - Get your trial subscription for unlimited access to all the components of Ansible Automation Platform.
* link:https://www.youtube.com/ansibleautomation[Red Hat Ansible Automation Platform YouTube channel].

== Troubleshooting

If you have encountered an issue or have noticed something not quite right, please link:https://github.com/ansible/instruqt/issues/new?labels=lightspeed-101&title=New+Intro+to+Lightspeed+issue:+configure-tools&assignees=craig-br[open an issue on GitHub].
